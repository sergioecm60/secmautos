<div class="card">
    <h3>üì• Importar Veh√≠culos desde Excel</h3>

    <!-- Campo oculto para CSRF token -->
    <input type="hidden" name="csrf_token" id="import-csrf-token" value="">

    <div id="import-loading" style="text-align: center; padding: 40px;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Cargando datos de importaci√≥n...</p>
        </div>
    </div>

    <div id="import-preview" style="display: none;">
        <div class="alert alert-info">
            <strong>üìã Origen:</strong> <span id="import-origen"></span><br>
            <strong>üìÖ Fecha de exportaci√≥n:</strong> <span id="import-fecha"></span><br>
            <strong>üìä Total de veh√≠culos:</strong> <span id="import-total"></span>
        </div>

        <div class="form-grid" style="margin-bottom: 20px;">
            <div class="form-group">
                <label>Modo de importaci√≥n</label>
                <select id="import-modo" class="form-control">
                    <option value="crear_nuevos">Crear solo veh√≠culos nuevos (omitir duplicados)</option>
                    <option value="actualizar_existentes">Actualizar veh√≠culos existentes + crear nuevos</option>
                </select>
                <small class="form-text text-muted">
                    Los duplicados se detectan por patente
                </small>
            </div>
        </div>

        <div id="import-stats" class="stats-grid" style="margin-bottom: 20px;">
            <div class="stat-card">
                <div style="font-size: 2em;">üì¶</div>
                <h4 id="stat-total">0</h4>
                <p>Total a procesar</p>
            </div>
            <div class="stat-card">
                <div style="font-size: 2em;">‚ú®</div>
                <h4 id="stat-nuevos">0</h4>
                <p>Veh√≠culos nuevos</p>
            </div>
            <div class="stat-card">
                <div style="font-size: 2em;">‚ôªÔ∏è</div>
                <h4 id="stat-existentes">0</h4>
                <p>Ya existen en BD</p>
            </div>
            <div class="stat-card">
                <div style="font-size: 2em;">üîó</div>
                <h4 id="stat-con-titulo">0</h4>
                <p>Con T√≠tulo DNRPA</p>
            </div>
        </div>

        <h5>Vista previa (primeros 10 veh√≠culos)</h5>
        <div class="table-responsive" style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
            <table class="table">
                <thead style="position: sticky; top: 0; background: var(--bg-secondary); z-index: 1;">
                    <tr>
                        <th>Estado</th>
                        <th>Patente</th>
                        <th>Marca</th>
                        <th>Modelo</th>
                        <th>A√±o</th>
                        <th>Titular</th>
                        <th>T√≠tulo DNRPA</th>
                    </tr>
                </thead>
                <tbody id="import-preview-table"></tbody>
            </table>
        </div>

        <div style="text-align: center;">
            <button type="button" class="btn btn-primary btn-lg" onclick="ejecutarImportacion()" id="btn-importar">
                üì• Iniciar Importaci√≥n
            </button>
            <button type="button" class="btn btn-secondary" onclick="cargarVehiculos()">
                ‚ùå Cancelar
            </button>
        </div>
    </div>

    <div id="import-progress" style="display: none; text-align: center; padding: 40px;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p id="import-progress-text">Importando veh√≠culos...</p>
        </div>
    </div>

    <div id="import-result" style="display: none;">
        <div class="alert" id="import-result-alert">
            <h4>‚úÖ Importaci√≥n Completada</h4>
            <div id="import-result-content"></div>
        </div>

        <div class="stats-grid" style="margin-bottom: 20px;">
            <div class="stat-card">
                <div style="font-size: 2em;">‚ú®</div>
                <h4 id="result-creados">0</h4>
                <p>Veh√≠culos creados</p>
            </div>
            <div class="stat-card">
                <div style="font-size: 2em;">‚ôªÔ∏è</div>
                <h4 id="result-actualizados">0</h4>
                <p>Veh√≠culos actualizados</p>
            </div>
            <div class="stat-card">
                <div style="font-size: 2em;">‚è≠Ô∏è</div>
                <h4 id="result-omitidos">0</h4>
                <p>Omitidos (duplicados)</p>
            </div>
            <div class="stat-card">
                <div style="font-size: 2em;">‚ùå</div>
                <h4 id="result-errores">0</h4>
                <p>Errores</p>
            </div>
        </div>

        <div id="import-errores" style="display: none; margin-top: 20px;">
            <h5>‚ö†Ô∏è Errores encontrados:</h5>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Patente</th>
                            <th>Error</th>
                        </tr>
                    </thead>
                    <tbody id="import-errores-table"></tbody>
                </table>
            </div>
        </div>

        <div style="text-align: center; margin-top: 20px;">
            <button type="button" class="btn btn-primary" onclick="cargarVehiculos()">
                üöó Ver Veh√≠culos Importados
            </button>
            <button type="button" class="btn btn-secondary" onclick="cargarImportador()">
                üîÑ Nueva Importaci√≥n
            </button>
        </div>
    </div>
</div>
